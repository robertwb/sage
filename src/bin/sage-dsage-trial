#!/usr/bin/env bash

# This script runs twisted trial against sage.dsage, returns
# 1 if any tests fail and 0 if all tests pass

if [ ! -d "$SAGE_ROOT/tmp/"  ]; then
    echo "tmp directory doesn't exist - creating ...";
    mkdir "$SAGE_ROOT/tmp/";
fi

if [ ! -d "$SAGE_ROOT/tmp/dsage-trial"  ]; then
    echo "dsage-trial tmp directory doesn't exist - creating ...";
    mkdir "$SAGE_ROOT/tmp/dsage-trial";
fi

echo "This script will run the unit tests for DSage"
trial --temp-directory="$SAGE_ROOT/tmp/dsage-trial"  sage.dsage

if [ $? != 0 ]; then
    echo "However, an ERROR occurred in the Distributed SAGE unit tests."
fi
