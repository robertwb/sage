<h1 id="meta">META</h1>

<p>Last Updated: 10/09/07 <br />
Contact Info: yqiang ATNOSPAM gmail.com  </p>

<h1 id="introduction">INTRODUCTION</h1>

<p>Distributed SAGE is a framework that allows one to do distributed
computing from within SAGE. It includes a server, client and workers as
well as a set of classes that one can subclass from to write distributed
computation jobs.</p>

<h1 id="requirements">REQUIREMENTS</h1>

<ul>
<li><a href="http://www.sagemath.org"><strong>SAGE 2.6</strong></a></li>
<li><a href="http://www.openssh.org"><strong>OpenSSH</strong></a></li>
</ul>

<h1 id="overview">OVERVIEW</h1>

<p>There are 3 distinct parts of Distributed SAGE:</p>

<ul>
<li><p>Server
The server is responsible for job distribution, submission and
collection.  </p></li>
<li><p>Client
The client is responsible for submitting new jobs to the server
and collecting the results. </p></li>
<li><p>Monitor <br />
The monitor controls workers which do the actual computation of
jobs. Sometimes monitors are referred to just as &#8216;workers&#8217;.</p></li>
</ul>

<h1 id="quick-start">QUICK-START</h1>

<ol>
<li>Launch sage</li>
<li><p>Run </p>

<p><code>sage: dsage.setup()</code> </p>

<p>For a <strong>really</strong> quick start, just hit ENTER on all questions.
This will create all the necessary supporting files to get <strong>DSAGE</strong>
running. It will create the databases, set up a private/public key for
authentication and create a SSL certificate for the server.</p></li>
<li><p>Launch a server, monitor and get a connection to the server:</p>

<p><code>sage: D = dsage.start_all()</code></p>

<p>This will start 2 workers by default.  You can change it by passing in the
<code>workers=N</code> argument where <code>N</code> is the number of workers you want. </p></li>
<li><p>To do a computation, use D just like any other SAGE interface. For
example:</p>

<p><code>sage: j = D('2+2')</code> <br />
<code>sage: j.wait()</code> <br />
<code>sage: j</code> <br />
<code>4</code>  </p>

<p>Explanation: <br />
Line 1 returns a JobWrapper object which is how one accesses the
results of a computation.  </p>

<p>Line 2 <code>j.wait()</code> will block until the job is finished</p>

<p>Line 3 calls <code>__repr__</code> on the job which in this case prints the result</p>

<p>You can put <strong>any valid</strong> SAGE code in the quotes and it will be
converted into a JobWrapper object and performed by a worker.</p></li>
</ol>

<h1 id="examples">EXAMPLES</h1>

<p>All examples below assume that you already have a connection to the DSAGE
server and have workers up and running. You can get to that stage by doing the
following from SAGE:</p>

<pre><code>sage: D = dsage.start_all()
</code></pre>

<h2 id="example1:">Example 1:</h2>

<p>In this example we have written some code in a separate file, called
<strong>dsage.sage</strong> and would like to send that file as a job to a worker. The
contents of the file are simply:</p>

<pre><code>DSAGE_RESULT = factor(randint(10^20, 10^30))
</code></pre>

<p>Our session looks like this:</p>

<pre><code>sage: j = D.eval_file('dsage.sage', 'test_job')
sage: j
No output.
sage: j.result
2 * 5 * 7 * 23 * 743 * 877 * 1213 * 462270878024426767
</code></pre>

<h2 id="example2:">Example 2:</h2>

<p>The above example is not very useful because rarely do you want to send just
<strong>ONE</strong> job to a worker. A more likely situation is if you want to factor a
list of 1000 integers over one hundred workers. We are going to use list
comprehension for the following example:</p>

<h1 id="increasingyourcomputingpower">INCREASING YOUR COMPUTING POWER</h1>

<p>At some point you will want to add more workers to your worker pool. To do
this is very easy, since authentication is done with public keys. You can find
your public/private key pair in:</p>

<pre><code>$HOME/.sage/dsage/dsage_key
$HOME/.sage/dsage/dsage_key.pub
</code></pre>

<p>We have a DSAGE server <em>A</em> and a DSAGE worker <em>B</em> which are on separate
machines. </p>

<p>Copy your public/private key pair from <em>A</em> to <em>B</em> using the same
path. Now, in a session on <em>B</em> issue the following command to connect to <em>A</em>:</p>

<pre><code>sage: dsage.worker(server=**hostname of *A***, port=**port of server A**)
</code></pre>

<p>Alternatively, you can also connect as an <strong>anonymous</strong> worker by issuing the following command:</p>

<pre><code>sage: dsage.worker(server=**hostname of *A***, port=**port of server A**,
                   anonymous=True)
</code></pre>

<p>Please note that some jobs will not be processed by anonymous workers because
of the security setting of the job, which will be explained in the Jobs
sections. </p>

<h1 id="files">FILES</h1>

<p>All <strong>DSAGE</strong> related files are in <code>$HOME/.sage/dsage</code>.</p>

<ul>
<li><code>$HOME/.sage/dsage/db</code> contains the database</li>
<li><code>$HOME/.sage/dsage/tmp_worker_files</code> contains the jobs workers process
(currently these are never cleaned up, but in the future they might be)</li>
</ul>

<h1 id="setup">SETUP</h1>

<p>Setting up DSAGE is done through the configuration utility <code>dsage.setup()</code> and
the related utilities <code>dsage.setup_client()</code>, <code>dsage.setup_worker()</code> and
<code>dsage.setup_server</code>. </p>

<h1 id="configuration">CONFIGURATION</h1>

<p>As of <strong>SAGE 2.6</strong>, <strong>DSAGE</strong> does not use configuration files anymore.
Everything can be configured on the fly by passing in parameters to the
various <strong>DSAGE</strong> methods. That means that if you want a permanent
configuration, you should write a <strong>SAGE</strong> script that hardcodes the
parameters you wish to use.
To find out the parameters that are available, you can simply look at the
method definitions of <code>dsage.server()</code>, <code>dsage.worker()</code>, and <code>DSage()</code>. </p>

<h1 id="usagenotaccurate">USAGE (NOT ACCURATE)</h1>

<ol>
<li>Client</li>
<li>Monitor</li>
<li>Server</li>
</ol>

<h1 id="advancedusage">ADVANCED USAGE</h1>

<p>More complicated usage of <strong>DSAGE</strong> will require the user to write some code.
We have tried to make this as simple as possible by providing most of the
functionality in a super class called DistributedFunction which is located in
<code>sage.dsage.dist_functions.DistributedFunction</code>.
There are several examples that illustrate how this is done.  You can find
these examples in</p>

<ul>
<li><code>sage.dsage.dist_functions.dist_function</code></li>
<li><code>sage.dsage.dist_functions.dist_povray</code></li>
<li><code>sage.dsage.dist_functions.dist_factor</code></li>
</ul>

<h1 id="bugs">BUGS</h1>

<p>Send bug reports to yqiang atNOSPAM gmail.com</p>

<h1 id="authors">AUTHORS</h1>

<p><a href="http://www.yiqiang.org">Yi Qiang</a></p>
