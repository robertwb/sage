#!/usr/bin/env bash

if [ "$SAGE64" = "yes" ]; then
   echo "Building a 64-bit version of the GNU Scientific Library (GSL)"
   CFLAGS="-m64 "; export CFLAGS
   CPPFLAGS="-m64 "; export CPPFLAGS
fi

# There is no need to add compiler options like -g -O2,
# as GSL includes them.

# An error "/bin/rm: cannot remove `libtoolT': No such file or directory"
# often resulted. The following web site suggests export RM to "rm -f"
# http://toxpenguin.blogspot.com/2009/09/solution-for-libtoolt-error.html
# which solved the problem.

export RM="rm -f"

cd src

./configure --prefix="$SAGE_LOCAL"

if [ $? -ne 0 ]; then
    echo "Error configuring GSL"
    exit 1
fi

$MAKE

if [ $? -ne 0 ]; then
    echo "Error building GSL"
    exit 1
fi

$MAKE install

if [ $? -ne 0 ]; then
    echo "Error installing GSL"
    exit 1
fi
