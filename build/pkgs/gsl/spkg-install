#!/usr/bin/env bash

if [ "$SAGE64" = "yes" ]; then
   echo "64 bit build"
   CFLAGS="-O2 -g -m64 "; export CFLAGS
   CPPFLAGS="-O2 -g -m64 "; export CPPFLAGS
fi

echo "patching infnan to force the use of the gsl's isinf"
cp -f patches/infnan.c src/sys/

cd src/

./configure --prefix="$SAGE_LOCAL" --enable-shared

if [ $? -ne 0 ]; then
    echo "Error configuring GSL"
fi

make

if [ $? -ne 0 ]; then
    echo "Error building GSL"
fi

make install

if [ $? -ne 0 ]; then
    echo "Error installing GSL"
fi
