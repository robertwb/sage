#!/usr/bin/env bash

if [ "x$SAGE64" = xyes ]; then
   echo "Building a 64-bit version of the GNU Scientific Library (GSL)"
   CFLAGS="$CFLAGS -m64 "
   CPPFLAGS="$CPPFLAGS -m64" ; export CPPFLAGS
fi

CFLAGS="$CFLAGS -g -O2"
export CFLAGS

# An error "/bin/rm: cannot remove `libtoolT': No such file or directory"
# often resulted. The following web site suggests export RM to "rm -f"
# http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=523750
# which solved the problem.

export RM="rm -f"

cd src

./configure --prefix="$SAGE_LOCAL"

if [ $? -ne 0 ]; then
    echo "Error configuring GSL"
    exit 1
fi

$MAKE

if [ $? -ne 0 ]; then
    echo "Error building GSL"
    exit 1
fi

$MAKE install

if [ $? -ne 0 ]; then
    echo "Error installing GSL"
    exit 1
fi
