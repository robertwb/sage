#!/bin/sh

if test "$#" != 1; then
  echo "usage: ./install <gmp-dir>";
  exit;
fi

GMP_DIR=$1


echo "Moving .asm files that are to be replaced to .asm.disabled ..."
mv $GMP_DIR/mpn/x86_64/addmul_1.asm $GMP_DIR/mpn/x86_64/addmul_1.asm.disabled
mv $GMP_DIR/mpn/x86_64/submul_1.asm $GMP_DIR/mpn/x86_64/submul_1.asm.disabled
mv $GMP_DIR/mpn/x86_64/add_n.asm $GMP_DIR/mpn/x86_64/add_n.asm.disabled
mv $GMP_DIR/mpn/x86_64/sub_n.asm $GMP_DIR/mpn/x86_64/sub_n.asm.disabled
mv $GMP_DIR/mpn/x86_64/x86_64-defs.m4 $GMP_DIR/mpn/x86_64/x86_64-defs.m4.orig

echo "Copying new .asm and x86_64-defs.m4 files ..."
cp ./*.asm $GMP_DIR/mpn/x86_64/
cp ./x86_64-defs.m4 $GMP_DIR/mpn/x86_64/

echo "Copying new gmp-mparam.h..."
cp ./gmp-mparam.h $GMP_DIR/mpn/x86_64/

echo "Done."
echo "You can now go to $GMP_DIR and configure/make/make_check as usual."
